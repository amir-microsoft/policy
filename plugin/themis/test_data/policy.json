{
  "attributes": {
    "strAttr": "string",
    "domain_name": "domain",
    "type": "string"
  },
  "policies": 
{
  "id": "Parent policy set",
  "alg": "FirstApplicableEffect",
  "policies": [
  {
    "id": "Query Policy Set",
    "target": [
      {
       "equal": [
          {"attr": "type"},
          {"val": {"type": "string", "content": "query"}}
       ]
      }
     ],
    "alg": {
      "id": "Mapper",
      "default": "DefaultPermitAction",
      "map": {
        "selector": {
          "uri": "local:actions/domain-actions",
          "type": "string",
          "path": [
            {
              "attr": "domain_name"
            }
          ]
        }
      },
      "alg": "DenyOverrides"
    },
    "rules": [
      {
        "id": "PermitAction",
        "effect": "Permit",
        "obligations": [
           {
            "strAttr": {
                "val": {"type":"string", "content": "PermitObligations"}
            }
          }
        ]
      },
      {
        "id": "DenyAction",
        "effect": "Deny",
        "obligations": [
           {
            "strAttr": {
                "val": {"type":"string", "content": "DenyObligations"}
            }
          }
        ]
      },
      {
        "id": "DefaultDenyAction",
        "effect": "Deny",
        "obligations": [
           {
            "strAttr": {
                "val": {"type":"string", "content": "DefaultDenyObligations"}
            }
          }
        ]
      },
      {
        "id": "DefaultPermitAction",
        "effect": "Permit",
        "obligations": [
           {
            "strAttr": {
                "val": {"type":"string", "content": "DefaultPermitObligations"}
            }
          }
        ]
      }
    ]
  },
  {
     "id": "Response Policy Set",
    "target": [
      {
       "equal": [
          {"attr": "type"},
          {"val": {"type": "string", "content": "response"}}
       ]
      }
     ],
     "alg": "FirstApplicableEffect",
     "rules": [
        {
          "effect": "Permit",
          "obligations": [
             {
              "strAttr": {
                  "val": {"type":"string", "content": "ResponsePermitObligations"}
              }
            }
          ]
        }
      ]
    }
   ]
  }
}

